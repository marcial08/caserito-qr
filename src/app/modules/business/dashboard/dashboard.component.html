<div class="dashboard">
  <!-- Welcome Section -->
  <div class="welcome-section mb-4 mb-md-5">
    <div class="d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center">
      <div class="mb-3 mb-md-0">
        <h1 class="mb-1 fw-bold">Bienvenido de nuevo, {{ businessName }}</h1>
        <p class="text-muted mb-0">Aquí tienes un resumen de tu actividad</p>
      </div>
      <div class="d-flex gap-2">
        <button class="btn btn-sm btn-outline-primary d-none d-md-block">
          <i class="fa fa-refresh me-1"></i> Actualizar
        </button>
        <button class="btn btn-sm btn-outline-secondary">
          <i class="fa fa-question-circle me-1"></i> Ayuda
        </button>
      </div>
    </div>
  </div>
  
  <!-- Metrics Grid -->
  <div class="row g-3 g-md-4 mb-4 mb-md-5">
    <div class="col-6 col-md-3">
      <div class="metric-card">
        <div class="metric-content">
          <div class="metric-icon">
            <i class="fa fa-qrcode"></i>
          </div>
          <div class="metric-info">
            <div class="metric-label">Escaneos Hoy</div>
            <div class="metric-value">45</div>
            <div class="metric-trend text-success">
              <i class="fa fa-arrow-up me-1"></i>12%
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="col-6 col-md-3">
      <div class="metric-card">
        <div class="metric-content">
          <div class="metric-icon">
            <i class="fa fa-eye"></i>
          </div>
          <div class="metric-info">
            <div class="metric-label">Visitas Totales</div>
            <div class="metric-value">342</div>
            <div class="metric-trend text-success">
              <i class="fa fa-arrow-up me-1"></i>8%
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="col-6 col-md-3">
      <div class="metric-card">
        <div class="metric-content">
          <div class="metric-icon">
            <i class="fa fa-shopping-basket"></i>
          </div>
          <div class="metric-info">
            <div class="metric-label">Productos</div>
            <div class="metric-value">{{ products.length || 0 }}</div>
            <div class="metric-subtitle">
              de {{ planLimits?.numeric?.max_products || 0 }}
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="col-6 col-md-3">
      <div class="metric-card">
        <div class="metric-content">
          <div class="metric-icon">
            <i class="fa fa-check-circle"></i>
          </div>
          <div class="metric-info">
            <div class="metric-label">Productos Activos</div>
            <div class="metric-value">{{ activeProductsCount }}</div>
            <div class="metric-subtitle">
              {{ (activeProductsCount / (products.length || 1) * 100).toFixed(0) }}% disponibles
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Quick Actions -->
  <div class="row mb-4 mb-md-5">
    <div class="col-12">
      <div class="section-header mb-3">
        <h3 class="section-title mb-0">Acciones Rápidas</h3>
        <a href="#" class="section-link d-none d-md-block">Ver todas</a>
      </div>
      
      <div class="row g-3">
        <div class="col-6 col-md-3">
          <a routerLink="/business/products/new" class="action-card">
            <div class="action-icon">
              <i class="fa fa-plus-circle"></i>
            </div>
            <div class="action-content">
              <h5 class="action-title">Agregar Producto</h5>
              <p class="action-description">Añade un nuevo producto a tu menú</p>
            </div>
          </a>
        </div>
        
        <div class="col-6 col-md-3">
          <a routerLink="/business/qr-codes" class="action-card">
            <div class="action-icon">
              <i class="fa fa-qrcode"></i>
            </div>
            <div class="action-content">
              <h5 class="action-title">Generar QR</h5>
              <p class="action-description">Crea un nuevo código QR</p>
            </div>
          </a>
        </div>
        
        <div class="col-6 col-md-3">
          <a routerLink="/business/menu" class="action-card">
            <div class="action-icon">
              <i class="fa fa-eye"></i>
            </div>
            <div class="action-content">
              <h5 class="action-title">Ver Menú</h5>
              <p class="action-description">Mira cómo ven tus clientes</p>
            </div>
          </a>
        </div>
        
        <div class="col-6 col-md-3">
          <a routerLink="/business/analytics" class="action-card">
            <div class="action-icon">
              <i class="fa fa-chart-line"></i>
            </div>
            <div class="action-content">
              <h5 class="action-title">Ver Analytics</h5>
              <p class="action-description">Analiza tu desempeño</p>
            </div>
          </a>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Content Grid -->
  <div class="row g-4">
    <!-- Recent Activity -->
    <div class="col-lg-8">
      <div class="content-card">
        <div class="content-card-header">
          <h5 class="content-card-title">Actividad Reciente</h5>
          <button class="btn btn-sm btn-link">Ver historial</button>
        </div>
        <div class="content-card-body">
          @if (isLoading) {
            <div class="loading-container">
              <app-loading-spinner message="Cargando actividad..."></app-loading-spinner>
            </div>
          }
          
          @if (!isLoading && recentActivity.length === 0) {
            <app-empty-state 
              icon="clock"
              title="No hay actividad reciente"
              description="Tu actividad aparecerá aquí cuando empieces a usar la plataforma"
              actionText="Crear primer producto"
              actionIcon="plus">
            </app-empty-state>
          }
          
          @if (!isLoading && recentActivity.length > 0) {
            <div class="activity-list">
              @for (activity of recentActivity; track activity.description) {
                <div class="activity-item">
                  <div class="activity-icon">
                    <i class="fa fa-{{ activity.icon }}"></i>
                  </div>
                  <div class="activity-content">
                    <div class="activity-text">{{ activity.description }}</div>
                    <div class="activity-time">{{ activity.time }}</div>
                  </div>
                </div>
              }
            </div>
          }
        </div>
      </div>
    </div>
    
    <!-- Plan Status -->
    <div class="col-lg-4">
      <div class="content-card">
        <div class="content-card-header">
          <h5 class="content-card-title">Tu Plan</h5>
          <span class="badge bg-success">Activo</span>
        </div>
        <div class="content-card-body">
          <div class="plan-info">
            <h4 class="plan-name">{{ currentPlan?.title || 'Profesional' }}</h4>
            <p class="plan-description">{{ currentPlan?.description || 'Plan profesional para negocios en crecimiento' }}</p>
            
            <div class="usage-section">
              <div class="usage-header">
                <span class="usage-label">Uso de productos</span>
                <span class="usage-value">{{ products.length || 0 }}/{{ planLimits?.numeric?.max_products || 100 }}</span>
              </div>
              <div class="progress">
                <div class="progress-bar" 
                     [style.width]="(products.length || 0) / (planLimits?.numeric?.max_products || 1) * 100 + '%'">
                </div>
              </div>
            </div>
            
            <div class="plan-features mt-4">
              <div class="feature-item">
                <i class="fa fa-check text-success me-2"></i>
                <span>Hasta {{ planLimits?.numeric?.max_categories || 20 }} categorías</span>
              </div>
              <div class="feature-item">
                <i class="fa fa-check text-success me-2"></i>
                <span>Hasta {{ planLimits?.numeric?.max_qr_codes || 20 }} códigos QR</span>
              </div>
              <div class="feature-item">
                <i class="fa fa-check text-success me-2"></i>
                <span>{{ planLimits?.numeric?.analytics_days || 90 }} días de analytics</span>
              </div>
            </div>
            
            <div class="plan-actions mt-4">
              <button class="btn btn-primary w-100 mb-2" routerLink="/billing/plans">
                <i class="fa fa-rocket me-2"></i>
                Cambiar Plan
              </button>
              <button class="btn btn-outline-secondary w-100">
                <i class="fa fa-file-text me-2"></i>
                Ver facturación
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>